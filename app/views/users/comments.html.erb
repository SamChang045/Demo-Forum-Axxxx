<div class="container bg-light">
  <div class="row pt-3">
    <div class="col-sm-12">
        <div class="row">
        <div class="col-sm-3 mt-3">
          <%= link_to user_path(@user), class: "nav-link" do %>
            <% if @user.avatar? %>
              <%= image_tag @user.avatar, width: "100%" %>
            <% else %>
              <%= fa_icon "user 5x" %>
            <% end %>
            <p class="text-center"><strong><%= @user.name %></strong></p>
          <% end %>
        </div>
        <div class="col-sm-9">
          <p><%= @user.description %></p>
          <% if @user == current_user %>
            <div class="d-flex flex-row-reverse">
              <%= link_to "Edit", edit_user_path(@user), class: "btn btn-primary" %>
            </div>
          <% else %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
    <ul class="nav nav-tabs">
      <li role="presentation" class="<%= "active" if current_page?(user_path(@user)) %>">
        <%= link_to 'Post', user_path(@user) %>
      </li>
      <li role="presentation" class="<%= "active" if current_page?(comments_user_path(@user)) %>">
        <%= link_to 'Comment', comments_user_path %>
      </li>
      <li role="presentation" class="<%= "active" if current_page?(collects_user_path(@user)) %>">
        <%= link_to 'Collect', collects_user_path%>
      </li>
      <% if @user == current_user %>
        <li role="presentation" class="<%= "active" if current_page?(drafts_user_path(@user)) %>">
          <%= link_to 'Draft', drafts_user_path %>
        </li>
      <% end %>
      <li role="presentation" class="<%= "active" if current_page?(friends_user_path(@user)) %>">
        <%= link_to 'Friend', friends_user_path %>
      </li>
    </ul>
  </div>
</div>
<div class="container">
  <div class="row">
    <% @comments.each do |comment| %>
      <div class="col-sm-12 border-top border-buttom bg-light">
        <div class="row align-items-center">
          <div class="col-sm-8 offset-sm-2" data-link="<%= post_path(comment.post) %>">
            <h4 class="m-3"><%= comment.post.title %></h4>
            <p class="border p-4 rounded bg-secondary text-white"><%= comment.content %></p>
          </div>
          <div class="col-sm-2">
            <% if comment.user == current_user || current_user.admin? %>
              <div class="buttons">    
                <%= link_to edit_current_comment_post_path(comment.post, comment_id: comment.id), remote: true, class: "p-2" do %>
                  <i class="fa fa-pencil-square fa-2x" aria-hidden="true"></i>
                <% end %>
                <%= link_to post_comment_path(comment.post,comment), method: :delete, data: { confirm: "Are you sure to delete?" }, class: "p-2 text-danger" do %>
                  <i class="fa fa-trash-o fa-2x" aria-hidden="true"></i>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
  $("div[data-link]").click(function() {
    window.location.href = $(this).attr("data-link")
  })
</script>